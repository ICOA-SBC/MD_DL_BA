Wed Apr 13 15:07:09 CEST 2022
mlflow:
  path: ${oc.env:luh_ALL_CCFRSCRATCH}/proli/mlruns
  runname: pafnucy_v0
io:
  input_dir: ${oc.env:luh_ALL_CCFRWORK}/deep_learning/pafnucy/data/CoG_12
  log_dir: ./log
  output_prefix: results/CoG_12/replicate_1/output
data:
  grid_spacing: 1.0
  max_dist: 12
  replicate: 1
network:
  conv_kernel_size: 5
  pool_kernel_size: 2
  conv_channels:
  - 19
  - 64
  - 128
  - 256
  dense_sizes:
  - 16384
  - 1000
  - 500
  - 200
  input_spatial_dim: 25
  conv_dims:
  - 19
  - 64
  - 256
  - 1024
  kp: 0.5
training:
  learning_rate: 1.0e-05
  batch_size: 20
  num_epochs: 5
  patience: 40
  weight_decay: 0.001
name: empty

training dataset with 13800 samples
	Partial charge normalization: m= -0.1401471346616745                     std= 0.4216829240322113

validation dataset with 3479 samples
	Partial charge normalization: m= -0.1401471346616745                     std= 0.4216829240322113

Number of available rotations: 24
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
Pafnucy                                  --                        --
├─Sequential: 1-1                        [20, 256, 4, 4, 4]        --
│    └─Conv3d: 2-1                       [20, 64, 25, 25, 25]      152,064
│    └─ReLU: 2-2                         [20, 64, 25, 25, 25]      --
│    └─MaxPool3d: 2-3                    [20, 64, 13, 13, 13]      --
│    └─Conv3d: 2-4                       [20, 128, 13, 13, 13]     1,024,128
│    └─ReLU: 2-5                         [20, 128, 13, 13, 13]     --
│    └─MaxPool3d: 2-6                    [20, 128, 7, 7, 7]        --
│    └─Conv3d: 2-7                       [20, 256, 7, 7, 7]        4,096,256
│    └─ReLU: 2-8                         [20, 256, 7, 7, 7]        --
│    └─MaxPool3d: 2-9                    [20, 256, 4, 4, 4]        --
├─Sequential: 1-2                        [20, 1]                   --
│    └─Linear: 2-10                      [20, 1000]                16,385,000
│    └─ReLU: 2-11                        [20, 1000]                --
│    └─Dropout: 2-12                     [20, 1000]                --
│    └─Linear: 2-13                      [20, 500]                 500,500
│    └─ReLU: 2-14                        [20, 500]                 --
│    └─Dropout: 2-15                     [20, 500]                 --
│    └─Linear: 2-16                      [20, 200]                 100,200
│    └─ReLU: 2-17                        [20, 200]                 --
│    └─Dropout: 2-18                     [20, 200]                 --
│    └─Linear: 2-19                      [20, 1]                   201
==========================================================================================
Total params: 22,258,349
Trainable params: 22,258,349
Non-trainable params: 0
Total mult-adds (G): 120.96
==========================================================================================
Input size (MB): 23.75
Forward/backward pass size (MB): 219.32
Params size (MB): 89.03
Estimated Total Size (MB): 332.10
==========================================================================================
===========================================
Layer                                      Param #
=====================                                   ======================
features.conv1_conv3d
                                                   152064
features.conv1_relu
features.conv1_maxpool
features.conv2_conv3d
                                                   1024128
features.conv2_relu
features.conv2_maxpool
features.conv3_conv3d
                                                   4096256
features.conv3_relu
features.conv3_maxpool
regressor.fc1_linear
                                                   16385000
regressor.fc1_relu
regressor.fc1_dropout
regressor.fc2_linear
                                                   500500
regressor.fc2_relu
regressor.fc2_dropout
regressor.fc3_linear
                                                   100200
regressor.fc3_relu
regressor.fc3_dropout
regressor.output
                                                   201
Epoch 1/5
	[train] MSELoss 16.4490
	[val] MSELoss 4.1643 	 Duration: 47.14
/\ Better loss 100.0 --> 4.164305703123947
Epoch 2/5
	[train] MSELoss 8.8632
	[val] MSELoss 3.7790 	 Duration: 45.48
/\ Better loss 4.164305703123947 --> 3.7790124859745458
Epoch 3/5
	[train] MSELoss 7.5220
	[val] MSELoss 3.7777 	 Duration: 45.60
/\ Better loss 3.7790124859745458 --> 3.777700056869362
Epoch 4/5
	[train] MSELoss 6.4671
	[val] MSELoss 4.2556 	 Duration: 45.53
Epoch 5/5
	[train] MSELoss 5.8984
	[val] MSELoss 5.0358 	 Duration: 45.53
[5 / 5] Best mean MSE: 3.7777             
	Total duration: 00:03:49
test dataset with 285 samples
	Partial charge normalization: m= -0.1401471346616745                     std= 0.4216829240322113

	[Test] MSELoss 4.7920
Wed Apr 13 15:12:01 CEST 2022
